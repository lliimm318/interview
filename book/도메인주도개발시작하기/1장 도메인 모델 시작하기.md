# 1장 도메인 모델 시작하기

## 도메인이란?
도메인 == 소프트웨어로 해결하고자 하는 문제 영역  !

한 도메인은 하위 도메인으로 나눠진다.
- 서점 도메인이 있으면 그 하위로 정산, 주문, 회원, 배송, 책 등등등
- 하위 도메인은 다른 하위 도메인과 연동하여 완전한 가능을 제공한다.
  - 물건 구매 시 -> 주문, 결제 등의 하위 도메인과 연결

특정 도메인을 위한 소프트웨어라고 해도 도메인이 제공하는 모든 기능을 직접 구현하지 않는다 !

-> 많은 온라인 쇼핑몰이 자체적으로 배송 시스템을 이용하지 않고 외부 배송 시스템을 사용하는 것 처럼! (like fassto...ㅎㅎ)

배송의 일부 기능은 자체 스템으로 구현하고 나머지 기능은 외부 업체의 시스템을 사용한다. 결제도 자체 페이가 아닌 토스페이, 네이버페이, 카카오페이 쓰는 것 처럼!

### 도메인 전문가와 개발 간 지식 공유

개발자는 요구사항을 바탕으로 개발한다.

만일 이 요구사항을 잘 이해하지 못했거나 잘못되었다면 -> !!! 충격적이다.

요구사항을 올바르게 이해하려면 개발자와 전문가가 직접 대화하는 것! 

물론 전문가의 요구사항이 항상 옳은 것은 아니다. 이럴 때 대화를 통해 해결하는 바람직한 개발자의 태도를 가져보아요오..

## 도메인 모델

도메인을 개념적으로 표현한 것! -> 도메인을 이해하기 위한 개념 모델

도메인 모델을 사용하면 동일한 모습으로 도메인을 이해하고 도메인 지식을 공유하는데 도움이 된다.

도메인 모델은 도메인을 이해하는데 도움이 된다면 어떤 표현 방법이든 가능하다

도메인을 이해하기 위한 **개념 모델**이다. 개념 모델로 바로 코드를 작성할 수 없다.
구현 기술에 맞는 모델이 따로 있어야 한다.

#### 하위 도메인과 모델

도메인은 여러 개의 하위 도메인으로 구성된다. 각 하위 도메인이 다루는 영역이 서로 달라 같은 용어라도 하위 도메인마다 의미가 달라질 수 있다.

ex) 입고의 상품은 입고되는 상품. 출고의 상품은 출고 되는 상품으로 용어는 같으나 의미가 다르다.

그래서 여러 하위 도메인을 하나의 다이어그램에 모델링 하면 안된다. 입고랑 출고를 같은 다이어그램에 표시하면 이해하는데 방해가 될 수 있다.

-> 모델의 각 구성 요소는 특정 도메인으로 완전해져서 각 하위 도메인마다 별도 모델을 만들어야 한다 !

## 도메인 모델 패턴

*보통의 어플리케이션 아키택쳐*

DB > 인프라스트럭처 > 도메인 > 응용 > UI

- UI : 사람이나 외부 시스템의 요청을 처리하고 정보를 보여줌. 
- 응용 : UI에서 요펑한 기능을 실행. 비지니스 로직 직접 구현 X. **도메인 계층을 조합해서 기능을 실행한다**
- 도메인 : 시스템이 제공할 도메인 규칙을 구현
- 인프라스트럭처 : 디비나 메세징 시스템 같은 외부 시스템과의 연동을 처리

검수 전에 취소할 수 있다. 16시 이후면 지연 도착처리 한다. 등등의 규칙 코드는 도메인 계층에 있다.

도메인 규칙을 객체지향 기법으로 구현하는 패턴이 도메인 모델 패턴이다. <책 31p>

**핵심 규칙을 구현한 코드는 도메인 모델에만 위치**하여 규칙이 변경되거나 확장해야할 때 다른 코드에 영향을 덜 주면서 변경 내역을 모델에 반영할 수 있게한다.

#### 개념모델 vs 구현모델
개념 모델 -> 순수하게 문제를 분석한 것.
- 데이터베이스나, 성능 등과 같은 것을 고려하지 않아 실제 코드를 작성할 때 처럼 모델을 있는 그대로 사용할 수 없다. (그래서 구현 가능한 형태의 모델로 전환해야 함)

개념 모델을 아무리 완벽하게 만들었다고 해도 완벽하게 도메인을 표현하는 것은 불가능하다.  새로운 지식이 쌓여 모델을 보안하거나 변경하게 된다.

개념 모델로 도메인에 대한 전체적인 윤곽을 이해하고 구현하면서 개념모델 -> 구현 모델로 발전 시켜야한다.

## Entity & Value

### Entity

식별자가 있다. (입고의 경우 PurchaseOrder가 엔티티 slipNo가 식별자.)

입고할 상품의 수량이 변경되거나 차량 번호가 변경 되어도 식별자는 바뀌지 않고 고유하다 !
== 식별자가 같으면 같은 엔티티이다.

#### 벨류 타입 (코드의 의미를 더 잘 이해할 수 있도록!)

출고에서 주문자와 주문자전화번호는 서로 다른 데이터지만 개념적으로 받는 사람을 의미한다.

이런 경우 주문자와 전화번호를 receicer로 묶어서 밸류 타입을 만들 수 있다.

밸류 타입은 2개 이상의 데이터 부터 만들 수 있는건 아니고 의미를 명확하게 표현하기 위해 사용할 수도 있다. <48p>

밸류 타입을 위한 기능을 추가할 수 있다.

ex) 돈 이라는 타입에 돈 계산하는 기능 넣기

밸류 타입 변경 시에는 기존 데이터를 변경하기 보단 변경한 데이터를 갖는 새로은 객체를 생성하는 방법을 선호한다.

-> 더하기 연산 시 + num한 것을 리턴하지않고 +num 한 것을 새롭게 객체 생성

왜냐 보통 밸류 타입을 불변으로 구현하는데.. 안전한 코드를 위해 !

만약 무언가 엉켜서 잘못 반영되면 문제가 생겨버려서요,,

#### 식별자와 밸류 타입
String id 라면 정확히 무슨 아이디인지 알기 어렵다. 

OrderNo id로 하여 타입 자체로 주문번호인 것을 알 수 있도록 !
