# AOP
AOP(Aspect Oriented Programming) 관점 지향 프로그래밍이다. 
관점 지향은 어떤 로직을 기준으로 **핵심적 관점과, 부가적 관점**으로 나누고 그 관점을 기준으로 각각 모듈화하겠다는 것!

핵심적인 관점은 핵심 비지니스 로직이 되고, 부가적인 관점은 핵심 로직 실행을 위한 연결, 로깅, 입출력 등이 있다.

### 목적
관점지향 프로그래밍은 객체지향 프로그래밍을 보완하기 위해 사용한다.

기존 객체 지향은 목적에 따라 클래스를 만들고 객체를 만든다. 
따라서 핵심 비지니스 로직이든, 부가 기능 로직이든 하나의 객체로 분리하는데 그치고, 이 기능들을 어떻게 바라보고 나눠쓸지에 대한 정의가 부족하다.

AOP는 각 관점을 기준으로 로직을 모듈화한다. 코드를 부분적으로 나누어 모듈화하겠다는 뜻이다. 
이때, 소스에서 다른 부분에 계속 반복되는 코드를 **흩어진 관심사(Crosscutting Concerns)** 라고 부른다.

![image](https://user-images.githubusercontent.com/66578746/227876548-e79d39c5-fda5-4292-b3b9-f2a15be1fc78.png)

AOP는 위 사진처럼 흩어진 관심사를 Aspect로 모듈화하고 핵심적인 비지니스 로직에서 분리해서 재사용한다.
흩어진 관심사를 핵심 비지니스 로직과 분리하여 코드의 간결성을 높이고 변경에 유연하고 확장이 유연하도록 가능하는것이 AOP의 목적이다.
<br/><br>
## AOP 적용 시점
1. 컴파일 시점 적용 <br/>
컴파일 시점에 바이트 코드를 조작해서 AOP가 적용된 바이트 코드를 생성한다. <br/>
AspectJ 컴파일러가 일반 .java 파일을 컴파일할 때 부가기능을 넣어서 .class 파일로 컴파일 해준다. 이를 위빙(weaving)이라고 한다

2. 클래스 로딩 시점 적용<br/>
순수하게 컴파일 후 클래스 로딩 시점에서 클래스 정보를 변경 <br/>
JVM내 클래스로더에 .class 파일을 올리는 시점에 바이트 코드를 조작해 부가기능 로직을 추가하는 방식이다.

3. 런타임 적용<br/>
**스프링 AOP가 주로 사용하는 방법!** 
컴파일, 클래스 로딩, main() 메서드의 실행 이후에 자바가 제공하는 범위내에 여러 개념과 기능을 총동원하여 **프록시를 통해 부가 기능을 적용** 하는 방식이다.
A라는 클래스 타입의 빈을 만들 때, A 타입의 프록시 빈을 생성해서 프록시 빈이 Aspect 코드를 추가하여 동작하는 방법

    프록시는 메소드 실행 시점에서만 다음 타겟을 호출할 수 있기 때문에, 런타임 시점에 부가기능을 적용하는 방식은 **메소드의 실행 시점으로 제한**된다.    
<br/><br>
## 스프링 AOP 특징
Spring AOP는 런타임 시점에 적용하는 방식을 사용한다.
컴파일 시점과 클래스 로딩 시점에 적용하면 별도의 컴파일러와 클래스로더 조작기가 필요한데, 이를 사용하고 유지하는 과정이 어렵고 복잡해서 사용하지 않는다.

- 접근 제어 및 부가기능을 추가하기 위해 AOP는 프록시 패턴 기반의 구현체이다. 
- 스프링 AOP는 순수 자바로 구현되어 특별한 컴파일 과정이 필요 없다.
- 스프링 빈에만 AOP를 적용가능하다.
- 모든 AOP기능을 제공하는 것이 아닌 스프링 loC와 연동하여 중복코드, 프록시 클래스 작성의 번거로움, 객체 복잡도 등 문제에 대한 해결책을 지원하는 것이 목표이다.
<br/><br>
## 용어
![image](https://user-images.githubusercontent.com/66578746/228161584-71e13800-bab4-41a6-b5ec-6f8ec82be4c3.png)

**Aspect**<br/>
흩어진 관심사를 모듈화한 것이다. 주로 부가 기능을 모듈화한다.

**Advice**<br/>
실질적인 기능을 담은 구현체

**JointPoint**<br/>
acvice가 적용될 위치이며 **메소드 실행 시점**을 의미한다. (메소드 진입 시점, 생성자 호출 시점, 등등 다양한 시점에서 적용 가능하다.)

**PointCut**<br/>
jointpoint의 상세를 정의한 것이다. 구체적으로 advice가 실행될 지점을 정할 수 있다. (ex. A라는 메소드 진입 시점에 호출할 것.)

**Target**<br/>
ascpect를 적용이 되는 대상 (클래스, 메소드 등등..)
<br/><br>
## AOP 어떻게 사용할까

maven
```maven
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-aop</artifactId>
</dependency>
```
gradle
``` gradle
implementation 'org.springframework.boot:spring-boot-starter-aop'
```

AOP 의존성을 추가해야 한다. 


<br/><br>
참고)

https://velog.io/@kai6666/Spring-Spring-AOP-%EA%B0%9C%EB%85%90
